
<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Royal Shop</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="canonical" href="https://getbootstrap.com/docs/5.2/examples/sign-in/">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">  
      <link rel="stylesheet" href="Other/css/login.css">  
      <script src="Other/js/Main.js"></script>

      </head>
      
      <body>
        <div img_display>
          <img class="img_display" src="Other/images/juddith.png" alt="" width="300" height="300" >
          </div>

      <div class='container'>
        <div class='card'>
          <h1> Entrar </h1>
          
          <div id='msgError'></div>
          
          <div class='label-float'>
            <input type='text' id='usuario' paceholder='' required="required">
            <label id='userLabel' for='usuario' >Usuario</label>
          </div>
          
          <div class='label-float'>
            <input type='password' id='senha' paceholder='' required="required">
            <label id='senhaLabel' for='senha'>Senha</label>
            <i class="fa fa-eye" aria-hidden="true"></i>
          </div>
          
          <div class='justify-center'>
            <button type="submit" onclick='entrar()'>Entrar</button>
          </div>
          <a href="index.html">
            <img  align="right" src="Other/images/voltar.svg">
          </a>
          <div class='justify-center'>
            
            
          </div>
      
          
        <p class="mt-5 mb-3 text-muted">&copy; 2022–2022 By Deskye</p>


          <p> Não tem uma conta?
            <a href='Cadastro.html'> Cadastre-se </a>
          </p>
          
        </div>
        </div>
    </main>
    
  </body>
  <script>
    let btn = document.querySelector('.fa-eye')

btn.addEventListener('click', ()=>{
  let inputSenha = document.querySelector('#senha')
  
  if(inputSenha.getAttribute('type') == 'password'){
    inputSenha.setAttribute('type', 'text')
  } else {
    inputSenha.setAttribute('type', 'password')
  }
})
let usuario = document.querySelector('#usuario')
let labelUsuario = document.querySelector('#userLabel')
let validUsuario = false

let senha = document.querySelector('#senha')
let labelSenha = document.querySelector('#senhalabel')
let validSenha = false

usuario.addEventListener('keyup', () => {
  if(usuario.value.length <= 4){
    userLabel.innerHTML = 'Preencha com um usuario'
  
    validUsuario = false
  } else {

    labelUsuario.innerHTML = 'Usuário'

    validUsuario = true
  }
})

senha.addEventListener('keyup', () => {
  if(senha.value.length <= 5){
    senhaLabel.innerHTML = 'Preencha corretamente'
    validSenha = false
  } else {
  
    senhaLabel.innerHTML = 'Senha'
 
    validSenha = true
  }
})




function entrar(){
  let usuario = document.querySelector('#usuario')
  let userLabel = document.querySelector('#userLabel')
  
  let senha = document.querySelector('#senha')
  let senhaLabel = document.querySelector('#senhaLabel')
  
  let msgError = document.querySelector('#msgError')
  let listaUser = []
  
  let userValid = {
    user: '',
    senha: '',
    email: '',
  }
  
  listaUser = JSON.parse(localStorage.getItem('listaUser'))
  
  listaUser.forEach((item) => {
    if(usuario.value == item.userCad && senha.value == item.senhaCad){
       
      userValid = {
        
         user: item.userCad,
         senha: item.senhaCad,
         email: item.emailCad
       }
      
    }
  })
   
  if(usuario.value == userValid.user && senha.value == userValid.senha && validSenha && validUsuario){
    window.location.href = 'index.html'
    
    let mathRandom = Math.random().toString(16).substr(2)
    let token = mathRandom + mathRandom
    
    localStorage.setItem('token', token)
    localStorage.setItem('userLogado', JSON.stringify(userValid))


   
  } else {
    userLabel.setAttribute('style', 'color: red')
    usuario.setAttribute('style', 'border-color: red')
    senhaLabel.setAttribute('style', 'color: red')
    senha.setAttribute('style', 'border-color: red')
    msgError.setAttribute('style', 'display: block')
    msgError.innerHTML = 'Usuário ou senha incorretos'
    usuario.focus()
  }
  
}
</script>
</html>
